packages:
  yum:
    git: []

commands:
  01_update_npm:
    command: "npm install -g npm@latest"
    ignoreErrors: true
    
container_commands:
  01_install_dependencies:
    command: "npm ci --only=production"
    leader_only: true
    
  02_create_log_dir:
    command: "mkdir -p /var/log/nodejs"
    ignoreErrors: true
    
files:
  "/opt/elasticbeanstalk/hooks/appdeploy/post/01_restart_node.sh":
    mode: "000755"
    owner: root
    group: root
    content: |
      #!/bin/bash
      # Restart the Node.js application
      initctl restart nodejs || initctl start nodejs